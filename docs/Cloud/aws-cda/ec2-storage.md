---
sidebar_position: 10
description: EC2에 연결할 수 있는 저장소
---

# EC2 Stroage

:::note
Instance Store는 물리적 서버에서 디스크 공간을 가져오고 네트워크 드라이브 보다 더 좋은 성능을 가진다. 그래서 I/O를 서버가 허용하는 최대한으로 만들어주지만 인스턴스와 분리되어 있지 않아 인스턴스가 망가지만 같이 망가질 수 있다.
:::

<br/>

## EBS

Elastic Block Store의 약자이며, network USB라고 생각하면 된다. 우리가 EC2를 사용하면서 우리도 모르게 계속 사용했던 것이다. 처음 EC2를 설정할 때, 디스크 용량을 설정하는데, 이는 EBS의 용량을 지정하는 것이고 지정한 EBS는 EC2의 Root Volume이 된다.

:::info
참고 - https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/AmazonEBS.html
:::

### 특징

* 물리 드라이브가 아닌 네트워크 드라이브이므로 지연이 생길 수 있다.
* 네트워크 드라이브이므로 인스턴스에서 분리되어 다른 인스턴스로 연결 가능하다.
* 하나의 인스턴스에만 연결가능하다. 예외적으로 io 유형은 같은 존의 여러 인스턴스에 연결가능하다.
* 반대로 인스턴스 하나에 2개의 EBS를 연결할 수 있다.
* Availability Zone(AZ)에 종속되어 다른 AZ에서 쓸 수 없다.
* 하지만 EBS 스냅샷을 이용하여 백업 및 다른 리전이나 존으로 옮기기가 가능하다.
* 처음에 사용할 용량 및 초당 전송수를 지정해야 하고, 이후에도 용량을 늘릴 수 있다.
* EC2에는 인스턴스 종료 시, EBS를 삭제하는 옵션이 있다.

### 타입

* gp2/gp3 SSD
  * 루트 볼륨으로 설정 가능하다.
  * 기본적인 비용 효과적인 볼륨 타입이다.
  * 최대 16000 IOPS, 1000 MiB/s를 지원한다.
  * gp2 - IOPS와 처리량이 연결되어 설정된다.
    * 1GiB 용량당 3IOPS를 지원하여 5334GiB 이상일 경우, 최대 IOPS 16000이 지정된다.
  * gp3 - IOPS와 처리량를 각각 설정 가능하다.
* io1/io2 SSD
  * 루트 볼륨으로 설정 가능하다.
  * 지연시간이 작아야 하는 대용량 작업에 쓰인다.
  * 최대 64000 IOPS (Nitro EC2)이며 기본적으로 32000 IOPS를 지원한다.
  * 해당 제품의 경우 예외적으로 여러 인스턴스와 연결가능하다.
    * 연결 시킬때는 cluster 인식 파일 시스템이 필요하다. 단, 가용영역(AZ)이 같아야 한다.
  * io2 Block Express
    * 최대 256000 IOPS를 지원하고 GiB당 1000IOPS를 지원해 준다.
* st1/sc1 HDD
  * 루트 볼륨으로 설정 불가능하다.
  * 비용이 저렴하다.
  * st1은 최대 500MiB/s, 500IOPS를 지원하고 빅데이터 쿼리정도에 알맞다.
  * sc1은 최대 250MiB/s, 250IOPS를 지원하고 콜드 아카이빙에 알맞다.

<br/>

## EFS

Elastic File System의 약자이며, EBS는 단일 가용 영역을 지원하지면 EFS는 다중 가용 영역을 지원해주고 쓴 만큼 돈을 내면 되는 시스템이다. Amazon에서 쓰는 NFS(네트워크 파일 시스템)라고 생각하면 된다.

:::info
참고 - https://docs.aws.amazon.com/ko_kr/efs/latest/ug/whatisefs.html
:::

### 특징

* 용량이 페타바이트급이라 용량에 구애 받지 않고 사용하며 쓴만큼만 비용을 지불한다.
* 리눅스에서만 지원한다.
* 초당 10GB의 처리량을 지원한다.
* 다른 모든 EC2 인스턴스가 모든 권한을 가지게 된다.
* NFSv4.1 Protocol로 동작한다.
* 여러 가용영역에 사용 가능하다.
* EBS보다 3배정도 비싸다.
* EFS-IA가 있으므로 비용 절감가능하다.
* EBS는 정해진 용량만큼 돈내고 EFS는 쓴만큼만 돈을 내서 상대적으로 EFS가 쌀 수도 있다.
* EFS는 NFS 포트를 통해 보안그룹과 보안그룹을 통해 연결해 줄 수 있다.

### 옵션

* 성능 모드
  * 범용 - 웹서버 운영이나 지연시간에 민감한 경우 사용한다. (기본)
  * Max I/O - 지연시간은 길어지지만 처리량이 병렬적으로 엄청난 향상을 준다.
* 처리량 모드
  * 버스팅 모드는 50 ~ 150 MiB/s for 1TB 처리량 지원한다. (기본)
  * 프로비져너 모드 사용하면 1GiB/s for 1TB 처리량을 지원한다.


### 스토리지 티어

EFS에는 데이터를 지정한 기간동안 사용하지 않으면 EFS-IA로 빼는 기능이 있다. 이는 콜드 아카이빙되며 저비용 스토리지로 넘어가게 된다. 즉, 처음 들어간 데이터는 스탠다드 스토리지에 있다가 지정한 기간동안 사용되지 않는 데이터는 EFS-IA로 콜드 아카이빙된다.

<br/>