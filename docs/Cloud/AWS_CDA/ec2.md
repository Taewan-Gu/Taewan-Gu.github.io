---
sidebar_position: 9
description: AWS에서 제일 기본적인 클라우드 컴퓨팅 자원
---

# EC2

:::note

> **공식문서 내용**
>
> Amazon Elastic Compute Cloud(Amazon EC2)는 Amazon Web Services(AWS) 클라우드에서 확장 가능 컴퓨팅 용량을 제공합니다. Amazon EC2를 사용하면 하드웨어에 선투자할 필요가 없어 더 빠르게 애플리케이션을 개발하고 배포할 수 있습니다. Amazon EC2를 사용하여 원하는 수의 가상 서버를 구축하고 보안 및 네트워킹을 구성하며 스토리지를 관리할 수 있습니다. Amazon EC2에서는 확장 또는 축소를 통해 요구 사항 변경 또는 사용량 스파이크를 처리할 수 있으므로 트래픽을 예측할 필요성이 줄어듭니다.
>
> 참고 - https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/concepts.html

AWS 공식 사이트에는 EC2에 대한 요약이 이렇게 적혀있다. 쉽게 말해, 자기들 서버에 하나의 가상컴퓨터를 올려서 빌려준다는 이야기이다. 그리고 이런 가상 컴퓨터를 빌려줄 때도 여러 가지 옵션이 있고, 신경써야할 사항들이 있고, 그에 대해 학습해보았다.
:::

<br/>

## 인스턴스 타입

세상에는 여러 서비스가 있기 때문에, **각 서비스에 맞는 인스턴스 타입을 선택하는 것이 중요**하다. 크게 compute Optimized, memory Optimized, storage Optimized로 나뉜다. 해당 부분들은 CPU / Memory / Storage 기준으로 어느 쪽에 더 좋은 성능을 가지고 인스턴스를 생성하여 빌릴지 선택하는 것이다. 그리고 그 인스턴스들은 어떠한 이름을 가지는데 그 이름은 해당 인스턴스의 성능을 표현한다. 예를 들어, m5.2xlarge에서 m은 instance class(m은 범용)를 뜻하고, 5는 generation, 2xlarge intance size(성능)를 뜻하게 된다.

:::info
인스턴스 타입, 성능, 가격 정리 표 사이트: https://instances.vantage.sh
:::

<br/>

## 보안 그룹

보안 그룹은 EC2의 방화벽을 설정하는 것이라고 보면 된다. IP(IPv4, IPv6), Port, 네트워크 인, 아웃바운드 설정을 해줄 수 있다.

- inbound rules: 해당 인스턴스로 들어올 수 있는 ip/port를 설정.
- outbound rules: 해당 인스턴스에서 외부 네트워크로 나갈 수 있는 ip/port를 설정.
- outbound rules는 첫 설정 시, 모든 곳으로 나갈 수 있도록 기본설정이 되어 있다.

### 특징

- region별로 보안그룹이 따로 설정해야 한다.
- EC2 바깥에서 작동한다.
- 연결 시, time out이 난다면 보안 그룹 문제이고, connection refused이 난다면 어플리케이션 문제이다.
- authorized(연결이 열린 상태), blocked(연결이 닫힌 상태) 연결 상태가 있다.

<br/>

## 구매 옵션

On-Demand가 쉽게 사용할 수 있는 옵션으로 쓴 만큼 돈을 내게 된다. 예약 인스턴스는 긴 기간(1년, 3년)의 사용을 예약하여 비용을 절감할 수 있게 한다. 전환형 예약 인스턴스는 예약 인스턴스와 비슷하지만 인스턴스 유형을 고정하는 예약 인스턴스와 달리 다른 인스턴스 유형으로 변경할 수 있다. 전용 호스트는 물리서버 자체를 예약해서 인스턴스를 커스텀으로 배치시킬 수 있다.

비용 계산은 OS 별로 다른데, 윈도우, 리눅스는 1분 이후 초당 비용 계산하고, 다른 OS는 1시간 마다 비용 계산을 한다.

### On-Demand

- 가격이 높다.
- 선결제가 없다.
- 약정이 없다.
- 언제든 사용 가능하고 중지 가능하다.
- 어플리케이션의 작동 방식을 예측할 수 없는 연속적인 단기 워크로드에 적합하다.

### Reserved Instances

- 온디맨드와 비교하면 최대 75% 비용 절감 가능하다.
- 1년보다 3년 예약이 훨씬 절감해준다.
- 비용 결제 방법은 매달 비용 지불과 할부 결제와 일시불이 있는데, 일시불이 제일 싸다.
- 인스턴스 타입을 무조건 고정해야 한다.
- 데이터베이스에 적합하다.

### Convertible Reserved Instances

- 최대 54% 까지 비용 절감 가능하다.
- 예약 인스턴스와 같지만, 인스턴스 타입을 변경할 수 있다.

### Scheduled Reserved Instances

- 기간을 예약하고 지정한 시간동안만 사용한다.
  - 예를 들어, 1년동안 하루 오전 10시 ~ 오후 6시까지만 사용하는 인스턴스가 있다.

### Spot Instances

- 최대 90% 까지 비용절감 가능하다.
- 스팟 가격은 점진적으로 변경되는데, max-price를 설정하여 해당 가격보다 더 크게 되면 알아서 중지된다.
- 인스턴스가 언제든 중단되어도 괜찮은 서비스를 넣어두는 것이 좋다.
- 데이터 분석 배치로드, 이미지 프로세싱, 배치 잡, 임시 서버 등이 있다.
- 중요한 작업과 데이터베이스는 절대 놔두면 안 된다.
- 해당 옵션은 내가 이 인스턴스를 사용하고 있는데 10달러를 내고 있는데, 누군가 이걸 12달러에 쓰겠다고 하면 내 인스턴스가 종료되고 다른 사람이 12달러에 사용하는 개념이다.

### Dedicated Host

- 물리적인 서버를 빌려서 해당 서버에서 인스턴스를 사용한다.
- 규정 준수 요건를 빌린사람이 설정 및 server-bound software license를 커스텀해서 사용할 수 있어서 비용 절감 가능하다.
- AWS 서버는 모두에게 공유하지만 이 서버는 다른 사용자에게 공유하지 못 하게 한다.
- 호스트 당 비용 청구를 한다.

### Dedicated Instance

- 물리적인 서버의 지정된 부분(첫 지정은 랜덤)에 인스턴스를 지정해서 사용한다.
- 물리적인 서버에 대한 설정은 할 수 없다.
- 인스턴스당 비용 청구한다.
- 일반 인스턴스가 정책, 라이센스, 규제, 보안 등으로 문제가 있을 때 사용한다.

<br/>

## AMI

Amazone Machine Image의 약자이며, 인스턴스에 소프트웨어를 사전 패키징 해놓은 이미지를 뜻한다.

* AWS 기본 제공하는 AMI가 있다.
* 커스텀으로 생성할 수 있다.
* 마켓플레이스를 이용해서 구입해 사용할 수 있다.
* 해당 지역에서만 사용가능하며 다른 지역으로 옮기려면 복사해서 옮겨서 사용해야 한다.

<br/>

## 부팅옵션

EC2가 부팅될 때 딱 한 번 실행되는 스트립트는 EC2 User Data 설정에서 커스텀으로 할 수 있다.

<br/>
